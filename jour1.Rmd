---
title: "Statistique univariée"
output:
  html_document:
    number_sections: yes
    toc: yes
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


Télécharger et ouvrir le fichier de données du cours.

# Termes

## Trouver des termes pour les objets en statistiques :
exemple : 
- variable, 
- observation,
- valeur

A vous !

On retiendra pour le moment uniquement les termes : individu / population / variable et modalité

## distinguer tableau complet, tig, tableau condensé

Individu -> Modalité
Modalité -> Individus

# L'essentiel : la forme d'une distribution

## Abscisses et ordonnées

![](img/distribution.jpg)


## Tiges et feuilles

discrétisation la plus rudimentaire

https://fr.khanacademy.org/math/be-4eme-secondaire2/x213a6fc6f6c9e122:statistiques-1/x213a6fc6f6c9e122:graphiques-statistiques/a/stem-and-leaf-plots-review


## Et sous un tableur

#### Resultat attendu

![](img/beatrice.png)

A déposer sur le moodle avec son prénom.png


### Préparation de l'exercice

#### Pour obtenir un TIG avec une seule variable, quelle variable choisir et pour quels individus ?

Dans l'exemple proposé, on choisit pour le nom d'une résidence, la colonne de la dénomination de l'appartement et le nombre de pièces.

```{r, echo=FALSE}
data <- read.csv("data/rplsBondy.csv", fileEncoding = "UTF-8")
choix <- data [grep("POTAGER",data$COMPLGEO), c("COMPLGEO","NUMAPPT","NBPIECE","CONSTRUCT")]
#choix <- data [data$COMPLGEO == 'RESIDENCE ALBERT THOMAS', c("NUMAPPT","NBPIECE")]
write.csv(choix, "data/choix.csv")
knitr::kable(head(choix))
```

Cet exercice permet d'utiliser dans le tableur :

- la suppression de colonne
- l'autofiltre pour sélectionner les données
- les 3 raccourcis clavier : CTRL + * , CTRL + C, CTRL + V


#### Tableau de fréquences sous Libre Office : savoirs faire

* Touche de sélection et de déplacement

* tri

* utilisation de la barre d'adresse

* utilisation des noms pour la formule

https://help.libreoffice.org/6.2/fr/text/scalc/guide/value_with_name.html

* formule frequence, formule matricielle (CTRL + MAJ + ENTREE)

* sélection pour exporter comme image



formules du tableau
![](img/frequence.png)


### Quel commentaire ?

- étendue
- forme de la distribution

#### Proposer une première représentation graphique

```{r, echo=FALSE}
choix <- read.csv("data/choix.csv", fileEncoding = "UTF-8")
knitr::kable(table(choix$NBPIECE))
hist(choix$NBPIECE, breaks = c(0,1,2,3,4,5),
     main =  paste0( "Dénombrement nombre de pièces\n", choix$COMPLGEO [1], " (", choix$CONSTRUCT [1],") "),
       xlab = "classes", ylab = "effectif")

```


## A explorer 

graphique en barres, lignes (lissage)

Observer la disposition des bornes : elles sont utilisées comme des étiquettes et non pas comme une série de valeurs.

## Correction graphiques étudiants



Exercice intitulé *dénombrement*

47 rendus sur 74


### Affichage de toutes les résidences

```{r, echo = FALSE}
data$COMPLGEO [(data$COMPLGEO == "")] <- "inconnu" 
residence <- unique(data$COMPLGEO)
residence [15] <- "inconnu"
par(mar = c(4,12,4,4))
barplot(sort(table(data$COMPLGEO)), horiz = T, 
        main = "Nb de logements",
        las = 2, cex.names = 0.8, border = NA)
png("img/nbpiece.png", height = 1800, width = 1800, res = 150)
par(mfrow = c(5,3))
for (i in 1:14){
  print(residence [i])
  choix <- data [data$COMPLGEO == residence [i],]
  amplitude <- c(min(choix$NBPIECE), max(choix$NBPIECE))
  bks <- seq(0, amplitude [2], by = 1)
  hist(choix$NBPIECE, breaks = bks,include.lowest = F,
     main =  paste0( choix$COMPLGEO [1], "\n(", choix$CONSTRUCT [1],") "),
       xlab = "classes", ylab = "effectif", axes = F, border = NA)
  axis(side=1, at=bks, labels=bks)
  maxNBPIECES <- max(table(choix$NBPIECE))
  axis(side = 2, at= seq(0, maxNBPIECES, by = maxNBPIECES))
}
dev.off()
```

![](img/nbpiece.png)


liste des problèmes rencontrés : 

### Pas grave mais attention

- nom du fichier... prénom.png

- attention choix de la série : résidence Carnot

- envoi copie d'écran et pas image

- tableau croisé dynamique plutôt que formule fréquence...

### Fondamental

- confusion somme et dénombrement

- graphique sur le TIG et pas sur le tableau condensé

![](img/1erreur.png)

- pas de paramétrage du graphique

![](img/2erreur.JPG)
![](img/3erreur.png)


![](img/parametrageGraphique.png)


### Questions

- autres sources

- intégration directe dans le moodle



# Pour raffiner : les indicateurs

Nous avons déjà vu l'amplitude à travers minimum et maximum. Il y en a d'autres.
Ils servent à résumer la série statistique


Pour l'exemple, on prend la cité du Stade.


```{r}
data <- read.csv("data/rplsBondy.csv", fileEncoding = "UTF-8")
stade <- data [ grep("STADE",data$COMPLGEO), c("NUMAPPT","NBPIECE")]
write.csv(stade, "data/stade.csv", fileEncoding = "UTF-8")
```


A votre avis pourquoi ? (cf forum sur le moodle)

## Calcul :  valeurs centrales et dispersion

### Valeurs centrales

Il s'agit de caractériser une distribution par son centre.

#### Moyenne et médiane

##### Calcul

Le calcul de la moyenne est connu. Celui de la médiane beaucoup moins.



###### Sur le tableau complet

Créer une colonne rang. Et relever le rang médian

![](img/mediane.jpg)




#### savoir faire tableur

- valeur fixe et relative (utilisation du $ et F4)

- au niveau graphique, rajout d'un axe par le menu insertion après double clic sur 
le graphique (onglet positionnement, menu déroulant valeur)


##### Que retenir ?

Expliquer ces phrases issues du Chadule

- La médiane est dans une distribution la valeur la plus *proche* de toutes les autres

Il s'agit d'une propriété mathématique de la médiane. 

- les valeurs extrêmes *décentrent* la moyenne




### Dispersion : Ecart-type et variance

La distribution est-elle hétérogène ?

#### 2 définitions : 

- écart moyen des valeurs à leur moyenne arithmétique

- moyenne du carré des écarts


#### Une question fondamentale : pourquoi utiliser les carrés ?

https://qastack.fr/stats/118/why-square-the-difference-instead-of-taking-the-absolute-value-in-standard-devia

et notamment, pour l'oeil du géographe :



*Une façon de penser à cela est que l’écart-type est similaire à une "distance par rapport à la moyenne".*

*Comparez cela à des distances dans un espace euclidien - ceci vous donne la vraie distance, où ce que vous avez suggéré (qui, en fait, est la déviation absolue ) ressemble plus à un calcul de distance manhattan .*



### Exercice en cours

Toujours sans passer par les formules, mais avec un tableau *pas à pas*, créer les indicateurs.

liste des colonnes :

- écart à la moyenne

- carré des écarts


- et à part sur une seule case : moyenne du carré des écarts (variance), l'écart type est la racine carrée.


## Appliquer : appréhender quelques indicateurs 

intitulé exercice *valeurs centrales et dispersion*

Sur une des résidences (sauf la cité du Stade) utilisée en cours, faire le graphique du TIG et indiquer la valeur centrale.

Rajouter une ligne de commentaire expliquant moyenne / médiane et écart type.


### Corrections quelques remarques 

L'objectif de l'exercice était d'obtenir un commentaire clair avec quelques repères statistiques.


#### Les bons graphiques


##### Un graphique du TIG

![](img/4erreurBon.png)


##### Une diagramme de répartition


![](img/bonDevoir3.png)


##### Quelles erreurs dans les graphiques suivants ?

![](img/1erreur.png)
![](img/2erreur.JPG)
![](img/3erreur.png)

### Les commentaires

Beaucoup d'étudiants ne voient pas la nécessité d'un commentaire...

#### Commentaire clair

*La moyenne et la médiane sont très proches. En effet, en moyenne, les logements de la résidence possèdent 3 pièces et 50 % des logements possèdent moins de 3 pièces. On peut en déduire que la série est assez homogène.De plus, l'écart type est faible, ce qui signifie que les valeurs sont peu dispersées autour de la moyenne et donc il vient confirmer que la série est homogène.*


#### trop technique 

![](img/tropTechnique.png)



#### Des commentaires intéressants


##### Un peu confus.

![](img/bonDevoir1.png)

##### Une réflexion sur le terme *hétérogène*



![](img/bonCommentaire.png)